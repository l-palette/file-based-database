# Файловая база данных (начало)
## Часть 1
Требуется реализовать простую информационную систему, поддерживающую учет книг домашней библиотеки. 
Среда разработки информационной системы на самостоятельный выбор.
В качестве файла с данными НЕЛЬЗЯ использовать XML, JSON, а также нельзя пользоваться библиотекой csv.
Ваша база данных должна состоять из одного файла, в файле каждая книга представлена одной записью. 
Каждая запись состоит из следующих полей:
• Название книги; - строка 
• Авторы (один или несколько); - Имя Фамилия Отчество; Имя2; Имя Фамилия
• Жанр; - строка
• Год выпуска; - год
• Ширина обложки; - число
• Высота обложки; - число
• Формат переплета (мягкий, твердый); - мягкий или твердый
• Источник появления (покупка, подарок, наследство); -
• Дата появления в библиотеке; - число-месяц-год
• Дата прочтения; - число-месяц-год
• Оценка c комментарием; - строка ограниченная по количеству символов, в начале число/10 - комментарий

Реализовать следующие методы:
1. Просмотр всего списка книг; 
2. Поиск нужной книги по названию, жанру, автору;
3. Добавление новой книги;
4. Редактирование данных книги;
5. Удаление книги;


### Ход работы
### Работа с текстовыми файлами
Работа с текстовыми файлами в Python довольно проста и интуитивно понятна. Вот основные операции, которые вы можете выполнять с текстовыми файлами:

##### 1. Открытие файла

Для работы с файлом сначала его нужно открыть с помощью функции `open()`. Вы можете указать режим открытия файла: чтение (`'r'`), запись (`'w'`), добавление (`'a'`) и другие.

```python
# Открытие файла для чтения
file = open('example.txt', 'r')
```

##### 2. Чтение из файла

Существует несколько способов чтения данных из файла:

- `read()`: считывает весь файл целиком.
- `readline()`: считывает одну строку.
- `readlines()`: считывает все строки и возвращает их в виде списка.

```python
# Чтение всего файла
content = file.read()
print(content)

# Чтение построчно
line = file.readline()
while line:
    print(line)
    line = file.readline()

# Чтение всех строк в список
lines = file.readlines()
for line in lines:
    print(line)
```
Если файл слишком большой, чтобы загружать его целиком в память, вы можете читать его по частям, используя цикл.

```python
with open('large_file.txt', 'r') as file:
    for line in file:
        process(line)  # Обработка каждой строки
```

##### 3. Запись в файл

Для записи в файл используйте режим `'w'` (перезапись) или `'a'` (добавление).

```python
# Открытие файла для записи
file = open('example.txt', 'w')

# Запись строки в файл
file.write('Hello, World!\n')

# Запись нескольких строк
lines_to_write = ['Line 1\n', 'Line 2\n', 'Line 3\n']
file.writelines(lines_to_write)
```

##### 4. Закрытие файла

После завершения работы с файлом его нужно закрыть, чтобы освободить ресурсы.

```python
file.close()
```

Рекомендуется использовать контекстный менеджер `with`, который автоматически закроет файл после завершения работы с ним.

```python
with open('example.txt', 'r') as file:
    content = file.read()
    print(content)

with open('example.txt', 'a') as file:
    file.write('New line added.\n')
```

##### 5. Перемещение указателя файла

Вы можете перемещать указатель файла с помощью методов `seek()` и `tell()`:

- `seek(offset, whence)`: перемещает указатель на заданное количество байтов от указанной позиции.
- `tell()`: возвращает текущее положение указателя в файле.

```python
with open('example.txt', 'r') as file:
    print(file.tell())  # Положение указателя в начале файла
    file.seek(0)        # Перемещение в начало файла
    print(file.read(5)) # Чтение первых 5 символов
```

### Структура базы данных

Для каждого столбца зададим максимальное количество символов и будем заполнять оставшиеся пробелами.
Таким образом к элементу строки можно будет возвращаться. Будем разделять столбцы символом |, а данные запятыми
```python
db_schema = {
    'name': {'type': 'string', 'length': 51, 'regex': 'А-Яа-яЁёA-Za-z0-9\s.,:;!?()\"\'-]+'},
    'authors': {'type': 'string', 'length': 51, 'regex': '[А-Яа-яЁёA-Za-z.]+\s[А-Яа-яЁёA-Za-z.]*\s[А-Яа-яЁёA-Za-z.]*'},
    'genre': {'type': 'string', 'length': 71, 'regex': '[А-Яа-яЁё]+'},       
    'year': {'type': 'integer', 'length': 5, 'regex': '\d+'},
    'width': {'type': 'float', 'length': 6, 'regex': '\d+\,\d+'},
    'height': {'type': 'float', 'length': 6, 'regex': '\d+\,\d+'},
    'type': {'type': 'string', 'length': 8, 'regex': 'мягкий|твердый'},
    'source': {'type': 'string', 'length': 11, 'regex': 'покупка|подарок|наследство'}, 
    'date-added': {'type': 'string', 'length': 11, 'regex': '\d+-\d+-\d+'}, 
    'date-read': {'type': 'string', 'length': 11, 'regex': '\d+-\d+-\d+'}, 
    'rating': {'type': 'string', 'length': 101, 'regex': '([1-9|10])/10 - .'}
}
```
### Методы
##### Просмотр списка книг
```python
with open('db.txt', 'r') as file:
    for line in file:
        select_name(line)  

```
```python
def select_name(line):
    print(line.read(100)) # Чтение первых 100 символов
```
##### Поиск книги по названию, жанру, автору
##### Добавление
##### Удаление
##### Редактирование

## Часть 2. Многопользовательская работа
1. Обеспечить параллельную (например, многотерминальную) работу с базой данных служащих библиотеки. 
Если опираться только на использование файлов, то для обеспечения корректности на все время
модификации любого из двух файлов доступ других пользователей к этому файлу будет блокирован 
(вспомните возможности файловых систем в отношении синхронизации параллельного доступа). 
Таким образом, ввод данных о новой книге существенно затормозит получение информации о списке книг 
в результате поиска, даже если данная книга не подходит под критерии поиска.
Поиск книги по названию, жанру, автору
##### Вывод всех книг
##### Поиск книги по названию, жанру, автору
##### Добавление
##### Удаление
##### Редактирование
2.Обеспечить целостность файла с данными в случае сбоев в работе информационной системы. 
Например, в случае аварийного выключения питания рабочей станции допустимы потеря только одной записи,
редактирование которой не было закончено – остальные данные должны быть сохранены в файл.

3. Обеспечить работоспособность информационной системы на большом объеме данных. Наполнить данными: 
не менее 10000 книг (данные должны быть осмысленные, не повторяющиеся), не менее 100 уникальных авторов. 
Проверить работу всех функций из предыдущей лабораторной работы. 

4. Обеспечить “прозрачность” работы с файлом данных для пользователей системы. Пользователи не должны 
задумываться открыли они файл или нет, сохранили данные в файл или нет – данные функции полностью
должны быть реализованы вашей информационной системой.